<mat-card class="category-detail-card" *ngIf="category">
  <div class="header">
    <h2>{{ category.name }}</h2>
    <div class="actions">
      <button mat-icon-button color="primary" (click)="enableEdit()" *ngIf="!editMode">
        <mat-icon>edit</mat-icon>
      </button>
      <button mat-icon-button color="warn" (click)="deleteCategory()">
        <mat-icon>delete</mat-icon>
      </button>
    </div>
  </div>

  <app-global-loader [loading]="loading" />
   <!-- ðŸ–¼ï¸ Image Preview (existing or new) -->
  <div class="image-container" *ngIf="category.coverImage || newImagePreview">
    <img
      [src]="newImagePreview || category.coverImage"
      alt="{{ category.name }}"
    />
  </div>



  <form [formGroup]="categoryForm" *ngIf="editMode" class="edit-form">

      <div class="upload-section">
      <label class="file-label">
        <mat-icon>upload</mat-icon>
        <span>Change Cover Image</span>
        <input type="file" (change)="onFileSelected($event)" />
      </label>
      <p *ngIf="newImageFile">{{ newImageFile.name }}</p>
    </div>

    <mat-form-field appearance="outline">
      <mat-label>Category Name</mat-label>
      <input matInput formControlName="name" />
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Description</mat-label>
      <textarea matInput formControlName="description"></textarea>
    </mat-form-field>

       <div class="form-actions">
      <button
        mat-flat-button
        color="primary"
        (click)="saveChanges()"
        [disabled]="uploadInProgress"
      >
        {{ uploadInProgress ? 'Saving...' : 'Save Changes' }}
      </button>
      <button mat-button (click)="editMode = false">Cancel</button>
    </div>
   
  </form>

 <div class="details" *ngIf="!editMode">
    <h3 class="category-name">{{ category.name }}</h3>
    <p
      class="category-description"
      [matTooltip]="category.description"
      matTooltipPosition="above"
    >
      {{ category.description ? (category.description.length > 100 ? (category.description | slice:0:100) + '...' : category.description) : 'No description provided' }}
    </p>
  </div>


</mat-card>
