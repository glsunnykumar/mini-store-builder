<h2 mat-dialog-title>
  {{ isEditMode ? 'Edit Product' : 'Add New Product' }}
</h2>

<div class="dialog-content">

   <app-global-loader [loading]="loading" />
  <form [formGroup]="productForm" class="form-container">

    <!-- ðŸ”¹ Category Dropdown -->
    <mat-form-field appearance="outline">
      <mat-label>Select Category</mat-label>
      <mat-select formControlName="categoryId">
        <mat-option *ngFor="let cat of categories" [value]="cat.id">
          {{ cat.name }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <!-- ðŸ”¹ Product Name -->
    <mat-form-field appearance="outline">
      <mat-label>Product Name</mat-label>
      <input matInput placeholder="Enter product name" formControlName="name" />
    </mat-form-field>

    <!-- ðŸ”¹ Description -->
    <mat-form-field appearance="outline">
      <mat-label>Description</mat-label>
      <textarea
        matInput
        placeholder="Enter product description"
        rows="3"
        formControlName="description"
      ></textarea>
    </mat-form-field>

    <!-- ðŸ”¹ Price -->
    <mat-form-field appearance="outline">
      <mat-label>Price (â‚¹)</mat-label>
      <input matInput type="number" placeholder="Enter price" formControlName="price" />
    </mat-form-field>

    <!-- ðŸ”¹ Image Upload -->
    <div class="upload">
      <label class="upload-label">
        <mat-icon>upload</mat-icon>
        <span>{{ selectedFile ? selectedFile.name : 'Choose Image' }}</span>
        <input type="file" accept="image/*" hidden (change)="onFileSelected($event)" />
      </label>

      <!-- Image Preview -->
      <div class="preview" *ngIf="imagePreview">
        <img [src]="imagePreview" alt="Preview" />
      </div>
    </div>
  </form>
</div>

<!-- ðŸ”¹ Footer Buttons -->
<div class="dialog-actions">
  <button mat-stroked-button (click)="cancel()">Cancel</button>

  <!-- ðŸ”¹ Show Delete only in Edit Mode -->
  <button
    *ngIf="isEditMode"
    mat-flat-button
    color="warn"
    (click)="deleteProduct()"
    [disabled]="loading"
  >
    Delete Product
  </button>


  <button
    mat-flat-button
    color="primary"
    (click)="saveProduct()"
    [disabled]="productForm.invalid || loading"
  >
    {{ isEditMode ? 'Update Product' : 'Save Product' }}
  </button>
</div>
